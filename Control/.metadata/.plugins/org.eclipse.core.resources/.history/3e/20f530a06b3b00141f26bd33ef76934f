/*
 * Light.cpp
 *
 *  Created on: 13 Sep 2014
 *      Author: ensab
 */

#include "Control.h"

Light::Light()
{
	for (uint8_t led = 0; led < 3; led++)
	colours[led] = 0;

}

void Light::Spin(unsigned long time)
{

}

void Light::Set(float r, float g, float b, float t)
{
	totalSteps = 0;
	int targets[3];
	targets[L_RED] = (int)(r*255.0);
	targets[L_GREEN] = (int)(g*255.0);
	targets[L_BLUE] = (int)(b*255.0);
	uint8_t led;

	for(led = 0; led < 3; led++)
	{
		int deltas[led] = targets[led] - colours[led];
		if(deltas[led] < 0)
		{
			colourPluses[led] = false;
			deltas[led] = -deltas[led];
		} else
			colourPluses[led] = true;
		if(deltas[led] > totalSteps)
			totalSteps = deltas[led];
	}


	counters[0] = -totalSteps/2;
	  for(led = 1; led < 3; led++)
	    counters[led] = counters[0];



	switches[RED]->On(r, t);
	switches[GREEN]->On(g, t);
	switches[BLUE]->On(b, t);
}

